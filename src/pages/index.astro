---
import Video from "../components/Video.astro";
import Youtube from "../components/Youtube.astro";
import "../styles/style.css";
import "../styles/layout.css";
import Button from "../components/Button.astro";
import Card from "../components/Card.astro";
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Work+Sans:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet" />
    <title>Astro</title>
  </head>
  <body>
    <div class="scroll_container">
      <div class="scroll_indicator"></div>
    </div>
    <header>
      <nav>
        <img src="/img/Logo.svg" alt="" />
        <Button> DONER </Button>
        <Video />
      </nav>
    </header>
    <main>
      <section class="standard_scroll_section">
        <h1>TRYLLEHATTEN</h1>
        <h4>Magien der skaber et smil</h4>
      </section>
      <section class="standard_scroll_section">
        <img src="/img/silke.svg" alt="" />
      </section>
      <section class="standard_scroll_section">
        <div class="blue">
          <p>Tryllehatten er vores samling af spasmagere, tryllekunstnere og filihankatte, som hver dag tager ud og spreder magien på landets hospitaler. De er alle fabelagtige magikere, som har spidskompetence i at trylle et smil frem på læberne hos syge børn og deres familier. Med deres fortryllende tricks, varme hjerter og evnen til at skabe en særlig forbindelse bringer de et kærkomment lys i en ofte svær tid. Tryllehatten skaber magiske øjeblikke fyldt med grin, forundring og håb – små pauser fra hverdagens udfordringer, hvor glæden får lov at fylde rummet. Det betyder også at alle donationer går ud til magikerne, så vi kan få dem ud så ofte som muligt.</p>
        </div>
      </section>
      <section class="standard_scroll_section">
        <div class="info1">
          <img src="/img/ballongroen.svg" alt="" />
          <div>
            <p>OVER</p>
            <h3 class="counter" data-target="90000">0</h3>
            <p>BØRN HAR FÅET TRYLLEHATTEN PÅ</p>
            <div class="tallet">
              <Button>FÅ TALLET TIL AT STIGE</Button>
            </div>
          </div>
        </div>
      </section>
      <section class="standard_scroll_section">
        <div class="info2">
          <div class="center">
            <h3>100%</h3>
            <p>AF DONATIONER GÅR TIL AT SKABE MAGISKE ØJEBLIKKE FOR BØRNENE</p>
          </div>
          <img src="/img/Ballonpink.svg" alt="" />
        </div>
      </section>
      <section class="standard_scroll_section">
        <h2>MØD TRYLLEKUNSTNERNE</h2>
        <div class="card-container">
          <div class="card">
            <img class="card-image" src="/img/tryllemichael.webp" alt="" />
            <h5 class="card-title">TRYLLE MICHAEL</h5>
            <p class="card-description">Michael tryller på Riget. Han er en ægte fortryllende magiker, der både får børn og voksne til at forbløffes.</p>
          </div>
          <div class="card">
            <img class="card-image" src="/img/LasseNK.webp" alt="" />
            <h5 class="card-title">LASSE NK</h5>
            <p class="card-description">Lasse spreder tryllestøv på Herlev, Hvidovre og Gram Slot. Han er mester til ballonkunst og har en populær segway.</p>
          </div>
        </div>
      </section>
      <section class="standard_scroll_section">
        <div class="card-container">
          <div class="card">
            <img class="card-image" src="/img/hennysolskin.webp" alt="" />
            <h5 class="card-title">HENNY SOLSKIN</h5>
            <p class="card-description">Henny Solskin er en ægte solstråle. Med hendes mange farver, dyr og bamser spreder hun glæde og smil på Herning hospital.</p>
          </div>
          <div class="card">
            <img class="card-image" src="/img/birger.webp" alt="" />
            <h5 class="card-title">BIRGER</h5>
            <p class="card-description">Birger tryller for KidsAid i Viborg og Odense. Han har optrådt for både store og små i over 20 år, og er derfor en meget erfaren magiker!</p>
          </div>
        </div>
      </section>
      <section class="standard_scroll_section">
        <div class="card-container">
          <div class="card">
            <img class="card-image" src="/img/helle.webp" alt="" />
            <h5 class="card-title">HELLE</h5>
            <p class="card-description">Helle er en vaskeægte Danmarksmester i børnetryl.</p>
          </div>
          <div class="card">
            <img class="card-image" src="/img/rasmusfupogfidus.webp" alt="" />
            <h5 class="card-title">RASMUS FUP & FIDUS</h5>
            <p class="card-description">Rasmus Fup & Fidus fra AUH tryller på forskellige børneafdelinger på Aarhus og Familiehuset.</p>
          </div>
        </div>
      </section>
      <section class="standard_scroll_section">
        <div class="card-container">
          <div class="card">
            <img class="card-image" src="/img/fabelagtigefalbe.webp" alt="" />
            <h5 class="card-title">FABELAGTIGE FALBE</h5>
            <p class="card-description">En altmulig-troldmand, som kan få hvert barn til at grine.</p>
          </div>
        </div>
      </section>
      <section class="standard_scroll_section">
        <div class="info3">
          <img class="left" src="/img/Kort.svg" alt="" />
          <div class="middle">
            <p>BLIV EN DEL AF DE</p>
            <h3 class="counter" data-target="3243">0</h3>
            <p>VIRKSOMHEDER, PERSONER OG FAMILIER, SOM ALLEREDE STØTTER TRYLLEHATTENS MAGI</p>
            <div class="stot">
              <Button>STØT</Button>
            </div>
          </div>
          <img class="right" src="/img/Spillekort.svg" alt="" />
        </div>
      </section>
      <section class="standard_scroll_section">
        <div class="gul">
          <p>Tryllehatten stræber efter ikke bare at være en samling af talentfulde kunstnere, men et koncept som også har plads til de skønne børn, som det hele handler om. De kan nemlig også få lov til at “få hatten på”, da mange af vores kunstnere deler ud af deres tricks, så børnene kan dele dem med deres familie og venner, når de kommer på besøg. På denne måde går vi efter at magien forbliver med børnene, selv når dagen er omme og tryllekunstnerne må drage hjemad.</p>
        </div>
        <h4>“Det var mega sjovt at se Trylle Michael i dag. Han lærte mig at lave et korttrick hvor man får kortet til at forsvinde. Det gør mig glad når de kommer forbi og tryller for os.”</h4>
        <p>- Malthe, 7 år</p>
      </section>
      <section class="standard_scroll_section">
        <h3>BESØG VORES SOCIALE MEDIER</h3>
        <div class="icons">
          <img src="/img/instagramlogo.png
		" alt="" />
          <img src="/img/linkedinlogo.png" alt="" />
          <img src="/img/facebooklogo.webp" alt="" />
        </div>
        <img class="instagram" src="/img/Instagram.webp" alt="" />
      </section>
      <section class="standard_scroll_section">
        <div id="hat"></div>
      </section>
      <footer></footer>
    </main>
  </body>
</html>

<script>
  window.addEventListener("scroll", onScroll);

  function onScroll() {
    const scrolled = document.body.scrollTop || document.documentElement.scrollTop;
    const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
    const scrolledfactor = (scrolled / height) * 100;
    document.querySelector(".scroll_indicator").style.width = `${scrolledfactor}%`;
  }

  import { animate, scroll } from "motion";
  animate("body", { opacity: [0, 1] }, { duration: 1 });

  const allStandardScrollSection = document.querySelectorAll(".standard_scroll_section");

  allStandardScrollSection.forEach((eachSection) => {
    scroll(animate(eachSection, { scale: [0, 1, 1, 0] }, { ease: "linear" }), {
      target: eachSection,
      offset: ["start end", "end end", "start start", "end start"],
    });
  });
  // TEST TEST TEST

  function animateCounter(element, start, end, duration) {
    const range = end - start;
    const increment = range / (duration / 16); // Approx 60fps
    let current = start;

    function updateCounter() {
      current += increment;
      if (current >= end) {
        current = end;
      }
      element.textContent = Math.floor(current).toLocaleString(); // Format with commas
      if (current < end) {
        requestAnimationFrame(updateCounter);
      }
    }

    updateCounter();
  }

  const counters = document.querySelectorAll(".counter");
  const animatedFlags = new WeakMap(); // Keep track of animated elements

  // Set up Intersection Observer
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        const element = entry.target;
        if (entry.isIntersecting && !animatedFlags.get(element)) {
          const target = parseInt(element.getAttribute("data-target"), 10);
          animatedFlags.set(element, true); // Mark as animated
          animateCounter(element, 0, target, 2000); // Animate from 0 to target in 2 seconds
        }
      });
    },
    {
      threshold: 0.5, // Trigger when 50% of the element is visible
    }
  );

  counters.forEach((counter) => observer.observe(counter));
</script>
